<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Miscelaneous functions · MolSimToolkit.jl</title><meta name="title" content="Miscelaneous functions · MolSimToolkit.jl"/><meta property="og:title" content="Miscelaneous functions · MolSimToolkit.jl"/><meta property="twitter:title" content="Miscelaneous functions · MolSimToolkit.jl"/><meta name="description" content="Documentation for MolSimToolkit.jl."/><meta property="og:description" content="Documentation for MolSimToolkit.jl."/><meta property="twitter:description" content="Documentation for MolSimToolkit.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="MolSimToolkit.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">MolSimToolkit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../system_setup/">System setup</a></li><li><a class="tocitem" href="../molecular_minimum_distances/">Molecular Minimum Distances</a></li><li><a class="tocitem" href="../block_averages/">Block averages</a></li><li><a class="tocitem" href="../remd/">Replica exchange</a></li><li><a class="tocitem" href="../procrustes/">Structural alignment</a></li><li><a class="tocitem" href="../secondary_structures/">Secondary structure</a></li><li class="is-active"><a class="tocitem" href>Miscelaneous functions</a></li><li><a class="tocitem" href="../Developer/">Developer zone</a></li><li><a class="tocitem" href="../plotting_style/">Plotting style</a></li><li><a class="tocitem" href="../Experimental/">Experimental</a></li><li><a class="tocitem" href="../Reweighting/">∘ Simulation Reweighting</a></li><li><a class="tocitem" href="../Coaraci/">∘ Cluster submission management</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Miscelaneous functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Miscelaneous functions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/m3g/MolSimToolkit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/m3g/MolSimToolkit.jl/blob/main/docs/src/miscelaneous.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Miscelaneous-functions"><a class="docs-heading-anchor" href="#Miscelaneous-functions">Miscelaneous functions</a><a id="Miscelaneous-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Miscelaneous-functions" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.bulk_coordination-Tuple{Simulation}" href="#MolSimToolkit.bulk_coordination-Tuple{Simulation}"><code>MolSimToolkit.bulk_coordination</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bulk_coordination(
    simulation::Simulation;
    reference_solute::AbstractVector{PDBTools.Atom}, 
    solute::AbstractVector{PDBTools.Atom},
    n_atoms_per_molecule_solute::Int,
    solvent::AbstractVector{PDBTools.Atom}, 
    n_atoms_per_molecule_solvent::Int,
    dmax::Real = 5.0,
    cutoff::Real = 20.0,
    bin_size::Real = 0.1,
    show_progress = true,
)</code></pre><p>Computes the coordination number of one type of solvent molecule relative to another  solvent molecule, as a function of the distance to a reference solute molecule. </p><p>For example, imagine a protein solvated in a mixture of water and TMAO. This function allows to compute the number of water molecules that are within a given distance to the TMAO molecules, as a function of the distance to the protein. That is, it computes the coordination number of water relative to TMAO, as a function of the distance to the protein.</p><p>The function returns the the distances and the histogram of the coordination number as a function of  the distance.</p><div class="admonition is-compat"><header class="admonition-header">Compat</header><div class="admonition-body"><p>This function was introduced in version 1.11.0 of MolSimToolkit.jl.</p></div></div><p><strong>Arguments</strong></p><ul><li><code>simulation::Simulation</code>: The simulation object</li><li><code>reference_solute::AbstractVector{PDBTools.Atom}</code>: The atoms of the reference solute molecule  (the protein in the example above).</li><li><code>solute::AbstractVector{PDBTools.Atom}</code>: The atoms of the solute molecule (the TMAO in the example above).</li><li><code>n_atoms_per_molecule_solute::Int</code>: The number of atoms per molecule of the solute.</li><li><code>solvent::AbstractVector{PDBTools.Atom}</code>: The atoms of the solvent molecule (the water in the example above).</li><li><code>n_atoms_per_molecule_solvent::Int</code>: The number of atoms per molecule of the solvent.</li><li><code>dmax::Real = 5.0</code>: The maximum distance to the solute to consider a solvent molecule as coordinated.</li><li><code>cutoff::Real = 20.0</code>: The maximum distance to the reference molecule for computing the histogram.</li><li><code>bin_size::Real = 0.1</code>: The size of the bins for the histogram.</li><li><code>show_progress = true</code>: Whether to show a progress bar.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using MolSimToolkit, PDBTools

julia&gt; pdb = readPDB(MolSimToolkit.Testing.namd2_pdb); # protein-tmao-water system

julia&gt; trajectory = MolSimToolkit.Testing.namd2_traj;

julia&gt; simulation = Simulation(pdb, trajectory)
Simulation 
    Atom type: Atom
    PDB file: -
    Trajectory file: /home/leandro/.julia/dev/MolSimToolkit/test/data/namd/protein_in_water_tmao/trajectory.dcd
    Total number of frames: 20
    Frame range: 1:1:20
    Number of frames in range: 20
    Current frame: nothing

julia&gt; r, h = bulk_coordination(
           simulation;
           reference_solute = select(pdb, &quot;protein&quot;),
           solute = select(pdb, &quot;resname TMAO&quot;),
           n_atoms_per_molecule_solute = 14,
           solvent = select(pdb, &quot;water&quot;),
           n_atoms_per_molecule_solvent = 3,
       );

julia&gt; using Plots

julia&gt; plot(r, h, # plots `h` as a function of `r`
           xlabel = &quot;Distance to protein (Å)&quot;,
           ylabel = &quot;TMAO-water Coordination number&quot;,
           linewidth=2,
           label=:none, framestyle=:box, fontfamily=&quot;Computer Modern&quot;,
       )</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/9c10eb30a0054f9329e7c066876ce8d2db890f8f/src/miscelaneous_functions/bulk_coordination.jl#L13-L93">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.intermittent_correlation-Union{Tuple{AbstractVector}, Tuple{F}} where F&lt;:Function" href="#MolSimToolkit.intermittent_correlation-Union{Tuple{AbstractVector}, Tuple{F}} where F&lt;:Function"><code>MolSimToolkit.intermittent_correlation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">intermittent_correlation(
    data::AbstractVector; 
    maxdelta = length(data) ÷ 10, 
    types::Function = x -&gt; true,
)</code></pre><p>Calculate the intermittent correlation function of a time series. That is, computes the probability of finding a value of the same type at a step <code>i + delta</code> in the time series, given that it was present in step <code>i</code>.</p><p>Returns an <code>OffsetArray</code> with indices <code>0:maxdelta</code>, where the value at position <code>0</code> is <code>1.0</code>, corresponding to the normalized count of events. </p><p><strong>Arguments</strong></p><ul><li><code>data::AbstractVector</code>: The time series to be analyzed. </li><li><code>maxdelta::Int</code>: The maximum delta-step to be considered. Defaults to  <code>length(data) ÷ 10</code>.</li><li><code>types</code> (optional): A function that returns <code>true</code> for the types of data  that should be considered. Defaults to all data, i. e. <code>x -&gt; true</code>. For   example, to ignore <code>0</code> values, use <code>types = x -&gt; x != 0</code>.  </li></ul><p><strong>Examples</strong></p><p>Here we produce a time-series of 10,000 elements, as a sequence of  1&#39;s and 0&#39;s (<code>[1, 0, 1, 0, ...]</code>), and calculate the intermittent correlation function. The probability of finding the same number (0 or 1) after odd steps is 0, and the probability of finding the same number after even steps is 1.</p><pre><code class="language-julia-repl hljs">julia&gt; using MolSimToolkit

julia&gt; data = [ mod(i,2) for i in 1:10^4 ];

julia&gt; intermittent_correlation(data; maxdelta=4)
5-element OffsetArray(::Vector{Float64}, 0:4) with eltype Float64 with indices 0:4:
 1.0
 0.0
 1.0
 0.0
 1.0

julia&gt; intermittent_correlation(data; maxdelta=4, types = x -&gt; x != 0)
5-element OffsetArray(::Vector{Float64}, 0:4) with eltype Float64 with indices 0:4:
 1.0
 0.0
 1.0
 0.0
 1.0</code></pre><p>In the second run, we have ignored the <code>0</code> values, and the result is the same,  because here the correlations of the <code>1</code> values are the same as the correlations of the <code>0</code> values.</p><div class="admonition is-compat"><header class="admonition-header">Compat</header><div class="admonition-body"><p>This function was added in version 1.9.0 of MolSimToolkit. The <code>types</code> argument was added in version 1.10.0.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/9c10eb30a0054f9329e7c066876ce8d2db890f8f/src/miscelaneous_functions/intermittent_correlation.jl#L1-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.distances-Tuple{Simulation, AbstractVector{Int64}, AbstractVector{Int64}}" href="#MolSimToolkit.distances-Tuple{Simulation, AbstractVector{Int64}, AbstractVector{Int64}}"><code>MolSimToolkit.distances</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">distances(simulation, indices1::AbstractVector{Int}, indices2::AbstractVector{Int})
distances(simulation, selection1::AbstractVector{PDBTools.Atom}, selection2::AbstractVector{PDBTools.Atom})</code></pre><p>Function that calculates the distance between the centers of mass of two selections in a simulation.</p><p>The selections are defined by the indices1 and indices2 vectors, which are the indices of the atoms, or by the selection1 and selection2 vectors, which are vectors of <code>PDBTools.Atom</code> objects.</p><p>Use <code>silent=true</code> to suppress the progress bar.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using PDBTools

julia&gt; using MolSimToolkit, MolSimToolkit.Testing

julia&gt; sim = Simulation(Testing.namd_pdb, Testing.namd_traj);

julia&gt; ats = atoms(sim);

julia&gt; i1 = findall(sel&quot;protein and residue 1&quot;, ats); # indices

julia&gt; i2 = findall(sel&quot;protein and residue 15&quot;, ats); # indices

julia&gt; distances(sim, i1, i2; silent=true)
5-element Vector{Float64}:
 23.433267858947584
 30.13791365033211
 28.48617683945202
 27.92740141686934
 23.235012287435566

julia&gt; distances(sim, 
           filter(sel&quot;protein and residue 1&quot;, ats), # selection (PDBTools.Atom)
           filter(sel&quot;protein and residue 15&quot;, ats); # selection (PDBTools.Atom) 
           silent=true
       )
5-element Vector{Float64}:
 23.433267858947584
 30.13791365033211
 28.48617683945202
 27.92740141686934
 23.235012287435566</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/9c10eb30a0054f9329e7c066876ce8d2db890f8f/src/miscelaneous_functions/distances.jl#L1-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PDBTools.center_of_mass-Tuple{AbstractVector{Int64}, Simulation, FramePositions}" href="#PDBTools.center_of_mass-Tuple{AbstractVector{Int64}, Simulation, FramePositions}"><code>PDBTools.center_of_mass</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">center_of_mass(
    indices::AbstractVector{Int};
    simulation::Simulation,
    positions::FramePositions,
    iref::Int = max(1, div(length(indices),2)),
)</code></pre><p>Calculate the center of mass of a selection of atoms in a simulation given the positions. The selection is defined by the <code>indices</code> vector, which is the indices of the atoms.</p><p>The <code>iref</code> parameter is the index of the reference atom. The center of mass is calculated by first computing the minimum-image of all atoms relative to this atom. By default, it is the atom closest to the middle of the indices vector.</p><pre><code class="language-julia-repl hljs">julia&gt; using PDBTools 

julia&gt; using MolSimToolkit, MolSimToolkit.Testing

julia&gt; simulation = Simulation(Testing.namd_pdb, Testing.namd_traj);

julia&gt; protein_indices = findall(sel&quot;protein&quot;, atoms(simulation));

julia&gt; first_frame!(simulation); # move simulation to the first frame

julia&gt; coor = positions(current_frame(simulation));

julia&gt; cm = center_of_mass(protein_indices, simulation, coor)
3-element Point3D{Float64} with indices SOneTo(3):
 -3.7290442807974906
 -1.5339226637687564
  1.960640754560446</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/9c10eb30a0054f9329e7c066876ce8d2db890f8f/src/miscelaneous_functions/center_of_mass.jl#L1-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.most_representative_structure-Tuple{Simulation}" href="#MolSimToolkit.most_representative_structure-Tuple{Simulation}"><code>MolSimToolkit.most_representative_structure</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">most_representative_structure(simulation::Simulation; atoms = nothing)</code></pre><p>Find the most representative structure in a simulation.  The most representative structure is the one that minimizes the RMSD with respect to the average structure of the simulation.  The average structure is defined iteratively, first by aligning all frames to the first frame, and then by averaging the aligned structures. The structure most similar to the average is then identified and used as the reference structure for the next iteration. The process is repeated until the structure most similar to the average is the same as the previous iteration.</p><p><strong>Arguments</strong></p><ul><li><code>simulation::Simulation</code>: Simulation object.</li><li><code>atoms</code>: Atoms to consider in the calculation:<ul><li><code>atoms</code> is <code>nothing</code>: the function will consider all alpha-carbons in proteins (<code>&quot;protein and name CA&quot;</code>).</li><li><code>atoms</code> is an <code>AbstractVector{&lt;:PDBTools.Atom}</code>: the function will consider the atoms in the vector.</li><li><code>atoms</code> is an <code>AbstractVector{&lt;:Int}</code>: the function will consider the atoms with the indices in the vector.</li><li><code>atoms</code> is a <code>String</code>: the function will consider the atoms selected by the string.</li></ul></li></ul><p><strong>Returns</strong></p><ul><li>Tuple <code>(Int, Float64)</code>, with:<ul><li>Index of the most representative structure.</li><li>RMSD of the most representative structure with respect to the average structure.</li></ul></li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using MolSimToolkit, MolSimToolkit.Testing, PDBTools

julia&gt; simulation = Simulation(Testing.namd_pdb, Testing.namd_traj);

julia&gt; most_representative_structure(simulation) # atoms == nothing (all alpha-carbons in proteins)
(4, 1.1681526249035976)

julia&gt; most_representative_structure(simulation; atoms = &quot;protein and name CA&quot;) # atoms is a String
(4, 1.1681526249035976)

julia&gt; calphas = select(atoms(simulation), &quot;name CA&quot;);

julia&gt; most_representative_structure(simulation; atoms = calphas) # atoms is an AbstractVector{PDBTools.Atom}
(4, 1.1681526249035976)

julia&gt; ica = PDBTools.index.(calphas)

julia&gt; most_representative_structure(simulation; atoms = ica) # atoms is an vector of indices
(4, 1.1681526249035976)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/9c10eb30a0054f9329e7c066876ce8d2db890f8f/src/miscelaneous_functions/most_representative_structure.jl#L16-L64">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../secondary_structures/">« Secondary structure</a><a class="docs-footer-nextpage" href="../Developer/">Developer zone »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Friday 4 October 2024 14:25">Friday 4 October 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
