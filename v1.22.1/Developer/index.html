<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Developer zone · MolSimToolkit.jl</title><meta name="title" content="Developer zone · MolSimToolkit.jl"/><meta property="og:title" content="Developer zone · MolSimToolkit.jl"/><meta property="twitter:title" content="Developer zone · MolSimToolkit.jl"/><meta name="description" content="Documentation for MolSimToolkit.jl."/><meta property="og:description" content="Documentation for MolSimToolkit.jl."/><meta property="twitter:description" content="Documentation for MolSimToolkit.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="MolSimToolkit.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">MolSimToolkit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../system_setup/">System setup</a></li><li><a class="tocitem" href="../molecular_minimum_distances/">Molecular Minimum Distances</a></li><li><a class="tocitem" href="../block_averages/">Block averages</a></li><li><a class="tocitem" href="../remd/">Replica exchange</a></li><li><a class="tocitem" href="../procrustes/">Structural alignment</a></li><li><a class="tocitem" href="../secondary_structures/">Secondary structure</a></li><li><a class="tocitem" href="../miscelaneous/">Miscelaneous functions</a></li><li class="is-active"><a class="tocitem" href>Developer zone</a><ul class="internal"><li><a class="tocitem" href="#Simulation"><span>Simulation</span></a></li><li><a class="tocitem" href="#Positions"><span>Positions</span></a></li><li><a class="tocitem" href="#Unit-cell"><span>Unit cell</span></a></li><li><a class="tocitem" href="#Wrap-coordinates"><span>Wrap coordinates</span></a></li></ul></li><li><a class="tocitem" href="../plotting_style/">Plotting style</a></li><li><a class="tocitem" href="../Experimental/">Experimental</a></li><li><a class="tocitem" href="../Reweighting/">∘ Simulation Reweighting</a></li><li><a class="tocitem" href="../Coaraci/">∘ Cluster submission management</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Developer zone</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Developer zone</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/m3g/MolSimToolkit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/m3g/MolSimToolkit.jl/blob/main/docs/src/Developer.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Developer-zone"><a class="docs-heading-anchor" href="#Developer-zone">Developer zone</a><a id="Developer-zone-1"></a><a class="docs-heading-anchor-permalink" href="#Developer-zone" title="Permalink"></a></h1><h2 id="Simulation"><a class="docs-heading-anchor" href="#Simulation">Simulation</a><a id="Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.Simulation" href="#MolSimToolkit.Simulation"><code>MolSimToolkit.Simulation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Simulation(pdb_file::String, trajectory_file::String; first=1, last=nothing, step=1)
Simulation(atoms::AbstractVector{&lt;:AtomType}, trajectory_file::String; first=1, last=nothing, step=1)</code></pre><p>Creates a new <code>Simulation</code> object. </p><p>The first constructor creates a <code>Simulation</code> object from a PDB file and a trajectory file. It will use the <code>PDBTools.Atom</code> for the atom type, which will populate the <code>atoms</code> vector of the <code>Simulation</code> object.</p><p>With the second constructor, the <code>atoms</code> vector is passed as an argument. This is useful when the atoms are provided by a different source than the PDB file. If the <code>AtomType</code> of the <code>atoms</code> vector conforms the <code>AtomsBase</code> interface, most functions in the <code>MolSimToolkit</code> will work with the <code>Simulation</code> object.</p><p>If <code>first</code>, <code>last</code>, and <code>step</code> are not specified, the <code>Simulation</code> will iterate over all frames in the file. </p><p>A <code>Simulation</code> object contains a trajectory file and a PDB data of the atoms. It can be iterated over to obtain the frames in the trajectory. The <code>Simulation</code> object is a mutable struct that contains the following data, that can be retrived by the corresponding functions:</p><ul><li><code>frame_range(::Simulation)</code>: the range of frames to be iterated over</li><li><code>frame_index(::Simulation)</code>: the index of the current frame in the trajectory</li><li><code>length(::Simulation)</code>: the number of frames to be iterated over in the trajectory file, considering the current range</li><li><code>raw_length(::Simulation)</code>: the number of frames in the trajectory file</li><li><code>atoms(::Simulation)</code>: the atoms in the simulation</li></ul><p>The Simulation object can also be manipulated by the following functions:</p><ul><li><code>close(::Simulation)</code>: closes the trajectory file</li><li><code>restart!(::Simulation)</code>: restarts the iteration over the trajectory file</li><li><code>first_frame!(::Simulation)</code>: restarts the iteration over the trajectory file and places the current frame at the first frame in the trajectory</li><li><code>current_frame(::Simulation)</code>: returns the current frame in the trajectory</li><li><code>next_frame!(::Simulation)</code>: reads the next frame in the trajectory file and returns it. Moves the current frame to the next one.</li><li><code>set_frame_range!(::Simulation; first, last, step)</code>: resets the range of frames to be iterated over. </li><li><code>get_frame(::Simulation, iframe)</code>: returns the frame at the given index in the trajectory.</li></ul><p>One important feature of the <code>Simulation</code> object is that it can be iterated over, frame by frame. </p><p>The <code>pairs</code> iterator can also be used to iterate over the frames, returning a tuple with the frame index and the frame itself. </p><p>The <code>enumerate</code> iterator can also be used to iterate over the frames, returning a tuple with the frame counter and the frame itself.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using MolSimToolkit, MolSimToolkit.Testing

julia&gt; simulation = Simulation(
           Testing.namd_pdb, Testing.namd_traj; 
           first = 2, step = 2, last = 4
       );

julia&gt; for frame in simulation 
           @show frame_index(simulation)
           # show x coordinate of first atom 
           @show positions(frame)[1].x
       end
frame_index(simulation) = 2
((positions(frame))[1]).x = 5.912472724914551
frame_index(simulation) = 4
((positions(frame))[1]).x = 7.346549034118652

julia&gt; for (i, frame) in pairs(simulation)
           @show i, frame_index(simulation)
       end
(i, frame_index(simulation)) = (2, 2)
(i, frame_index(simulation)) = (4, 4)  

julia&gt; for (i, frame) in enumerate(simulation)
           @show i, frame_index(simulation)
       end
(i, frame_index(simulation)) = (1, 2)
(i, frame_index(simulation)) = (2, 4)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/7b714d12e8c2ee90e8688dfb5c9faa117d3b4186/src/datastructures/Simulation.jl#L19-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.close-Tuple{Simulation}" href="#Base.close-Tuple{Simulation}"><code>Base.close</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">close(simulation::Simulation)</code></pre><p>Closes the trajectory file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/7b714d12e8c2ee90e8688dfb5c9faa117d3b4186/src/datastructures/Simulation.jl#L203-L208">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.length-Tuple{Simulation}" href="#Base.length-Tuple{Simulation}"><code>Base.length</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">length(simulation::Simulation)</code></pre><p>Returns the number of frames to be iterated over in the trajectory file, considering the current frame range.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/7b714d12e8c2ee90e8688dfb5c9faa117d3b4186/src/datastructures/Simulation.jl#L219-L225">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.atoms-Tuple{Simulation}" href="#MolSimToolkit.atoms-Tuple{Simulation}"><code>MolSimToolkit.atoms</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">atoms(simulation::Simulation)</code></pre><p>Returns the atoms in the simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/7b714d12e8c2ee90e8688dfb5c9faa117d3b4186/src/datastructures/Simulation.jl#L228-L233">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.current_frame-Tuple{Simulation}" href="#MolSimToolkit.current_frame-Tuple{Simulation}"><code>MolSimToolkit.current_frame</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">current_frame(simulation::Simulation)</code></pre><p>Returns the current frame in the trajectory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/7b714d12e8c2ee90e8688dfb5c9faa117d3b4186/src/datastructures/Simulation.jl#L268-L273">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.first_frame!-Tuple{Simulation}" href="#MolSimToolkit.first_frame!-Tuple{Simulation}"><code>MolSimToolkit.first_frame!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">first_frame!(simulation::Simulation)</code></pre><p>Restarts the trajectory buffer, and places the current frame at the first frame in the trajectory.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using MolSimToolkit, MolSimToolkit.Testing

julia&gt; simulation = Simulation(Testing.namd_pdb, Testing.namd_traj);

julia&gt; first_frame!(simulation) 
Simulation 
    Atom type: Atom
    PDB file: structure.pdb
    Trajectory file: structure.dcd
    Total number of frames: 5
    Frame range: 1:1:5
    Number of frames in range: 5
    Current frame: 1</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/7b714d12e8c2ee90e8688dfb5c9faa117d3b4186/src/datastructures/Simulation.jl#L281-L303">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.frame_index-Tuple{Simulation}" href="#MolSimToolkit.frame_index-Tuple{Simulation}"><code>MolSimToolkit.frame_index</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">frame_index(simulation::Simulation)</code></pre><p>Returns the index of the current frame in the trajectory. Returns <code>nothing</code>  if no frame frame from the trajectory range has been read yet.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/7b714d12e8c2ee90e8688dfb5c9faa117d3b4186/src/datastructures/Simulation.jl#L194-L200">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.frame_range-Tuple{Simulation}" href="#MolSimToolkit.frame_range-Tuple{Simulation}"><code>MolSimToolkit.frame_range</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">frame_range(simulation::Simulation)</code></pre><p>Returns the range of frames to be iterated over.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/7b714d12e8c2ee90e8688dfb5c9faa117d3b4186/src/datastructures/Simulation.jl#L186-L191">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.get_frame-Tuple{Simulation, Integer}" href="#MolSimToolkit.get_frame-Tuple{Simulation, Integer}"><code>MolSimToolkit.get_frame</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_frame(simulation::Simulation, iframe::Integer)</code></pre><p>Returns the frame at the given index in the trajectory. </p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using MolSimToolkit, MolSimToolkit.Testing, PDBTools

julia&gt; sim = Simulation(Testing.namd_pdb, Testing.namd_traj);

julia&gt; frame4 = get_frame(sim, 4)
   Array{Atoms,1} with 20465 atoms with fields:
   index name resname chain   resnum  residue        x        y        z occup  beta model segname index_pdb
       1    N     ILE     P      211        1   -0.397   12.048   37.441  1.00  0.00     1    PROT         1
       2  HT1     ILE     P      211        1   -0.779   11.123   37.726  1.00  0.00     1    PROT         2
       3  HT2     ILE     P      211        1   -0.393   12.662   38.280  1.00  0.00     1    PROT         3
                                                       ⋮ 
   20463  SOD     SOD     S       13     4374  -11.686   23.749   19.935  1.00  0.00     1     SOD     20463
   20464  SOD     SOD     S       14     4375  -34.214   38.148   55.179  1.00  0.00     1     SOD     20464
   20465  SOD     SOD     S       15     4376    7.220  -52.702   66.223  1.00  0.00     1     SOD     20465

julia&gt; writePDB(frame4, &quot;frame4.pdb&quot;)</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The <code>get_frame</code> function will read the frames in the trajectory until the desired frame is reached.  This can be slow for large trajectories. If the required frame is before the current frame of the  simulation, the simulation will be restarted. The simulation object is returned positioned in the required frame. </p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/7b714d12e8c2ee90e8688dfb5c9faa117d3b4186/src/datastructures/Simulation.jl#L400-L432">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.next_frame!-Tuple{Simulation}" href="#MolSimToolkit.next_frame!-Tuple{Simulation}"><code>MolSimToolkit.next_frame!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">next_frame!(simulation::Simulation)</code></pre><p>Reads the next frame in the trajectory file and returns it. Moves the current frame to the next one in the range to be considered (given by <code>frame_range(simulation)</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/7b714d12e8c2ee90e8688dfb5c9faa117d3b4186/src/datastructures/Simulation.jl#L310-L316">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.path_pdb-Tuple{Simulation}" href="#MolSimToolkit.path_pdb-Tuple{Simulation}"><code>MolSimToolkit.path_pdb</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">path_pdb(simulation::Simulation)</code></pre><p>Returns the path to the pdb file of the simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/7b714d12e8c2ee90e8688dfb5c9faa117d3b4186/src/datastructures/Simulation.jl#L236-L241">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.path_trajectory-Tuple{Simulation}" href="#MolSimToolkit.path_trajectory-Tuple{Simulation}"><code>MolSimToolkit.path_trajectory</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">path_trajectory(simulation::Simulation)</code></pre><p>Returns the path to the trajectory file of the simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/7b714d12e8c2ee90e8688dfb5c9faa117d3b4186/src/datastructures/Simulation.jl#L244-L249">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.raw_length-Tuple{Simulation}" href="#MolSimToolkit.raw_length-Tuple{Simulation}"><code>MolSimToolkit.raw_length</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">raw_length(simulation::Simulation)</code></pre><p>Returns the number of frames in the trajectory file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/7b714d12e8c2ee90e8688dfb5c9faa117d3b4186/src/datastructures/Simulation.jl#L211-L216">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.restart!-Tuple{Simulation}" href="#MolSimToolkit.restart!-Tuple{Simulation}"><code>MolSimToolkit.restart!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">restart!(simulation::Simulation)</code></pre><p>Restarts the iteration over the trajectory file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/7b714d12e8c2ee90e8688dfb5c9faa117d3b4186/src/datastructures/Simulation.jl#L252-L257">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.set_frame_range!-Tuple{Simulation}" href="#MolSimToolkit.set_frame_range!-Tuple{Simulation}"><code>MolSimToolkit.set_frame_range!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_frame_range!(simulation::Simulation; first=1, last=nothing, step=1)</code></pre><p>Resets the frame range to be iterated over. This function will restart the iteration of the simulation trajectory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/7b714d12e8c2ee90e8688dfb5c9faa117d3b4186/src/datastructures/Simulation.jl#L383-L389">source</a></section></article><h2 id="Positions"><a class="docs-heading-anchor" href="#Positions">Positions</a><a id="Positions-1"></a><a class="docs-heading-anchor-permalink" href="#Positions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.positions-Tuple{Chemfiles.Frame}" href="#MolSimToolkit.positions-Tuple{Chemfiles.Frame}"><code>MolSimToolkit.positions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">positions(frame::Chemfiles.Frame)</code></pre><p>Return the positions of the atoms in a <code>Chemfiles.Frame</code> as a <code>FramePositions</code> object.</p><p>This is the default way to access the positions of the atoms in a simulation.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using MolSimToolkit, MolSimToolkit.Testing

julia&gt; simulation = Simulation(Testing.namd_pdb, Testing.namd_traj);

julia&gt; frame = current_frame(simulation);

julia&gt; p = positions(frame);

julia&gt; p[1].x 
5.912472724914551
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/7b714d12e8c2ee90e8688dfb5c9faa117d3b4186/src/datastructures/Positions.jl#L97-L120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.FramePositions" href="#MolSimToolkit.FramePositions"><code>MolSimToolkit.FramePositions</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FramePositions{T,P&lt;:Point3D{T},M&lt;:AbstractArray{T}} &lt;: AbstractVector{P}</code></pre><p>Container for the positions of a set of atoms. The positions are stored in a matrix, where each column corresponds to the coordinates of an atom. The container is used such that using the coodinates from a <code>Chemfiles.Frame</code> is transparent to the user, and the coordinates can be accessed as <code>p[i]</code> where <code>i</code> is the index of the atom. </p><p>The coordinates of the atom can be accessed as <code>p[i].x</code>, <code>p[i].y</code>, and <code>p[i].z</code>.</p><p>A <code>FramePositions</code> object can be created with the <code>positions</code> function. The construction with <code>FramePositions</code> is not considered part of the public API.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using MolSimToolkit, MolSimToolkit.Testing

julia&gt; simulation = Simulation(Testing.namd_pdb, Testing.namd_traj);

julia&gt; frame = current_frame(simulation);

julia&gt; p = positions(frame)
20465-element FramePositions{Float64, Point3D{Float64}, Chemfiles.ChemfilesArray}:
 [5.912472724914551, 10.768872261047363, 28.277008056640625]
 [5.040304183959961, 10.810898780822754, 27.71207046508789]
 ⋮
 [11.16289234161377, -37.30374526977539, 22.80788230895996]

julia&gt; p[1]
3-element Point3D{Float64} with indices SOneTo(3):
  5.912472724914551
 10.768872261047363
 28.277008056640625

julia&gt; p[1].x
5.912472724914551

julia&gt; p[1].y
10.768872261047363

julia&gt; p[1].z
28.277008056640625</code></pre><p>It is also possible to take slices and views of the positions:</p><pre><code class="nohighlight hljs">julia&gt; p[1:2]
2-element FramePositions{Float64, Point3D{Float64}, Matrix{Float64}}:
 [5.912472724914551, 10.768872261047363, 28.277008056640625]
 [5.040304183959961, 10.810898780822754, 27.71207046508789]

julia&gt; @view(coor[1:2])
 2-element FramePositions{Float64, Point3D{Float64}, SubArray{Float64, 2, Chemfiles.ChemfilesArray, Tuple{Base.Slice{Base.OneTo{Int64}}, UnitRange{Int64}}, false}}:
  [5.912472724914551, 10.768872261047363, 28.277008056640625]
  [5.040304183959961, 10.810898780822754, 27.71207046508789]
 </code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/7b714d12e8c2ee90e8688dfb5c9faa117d3b4186/src/datastructures/Positions.jl#L18-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.Point3D" href="#MolSimToolkit.Point3D"><code>MolSimToolkit.Point3D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Point3D{T}</code></pre><p>A point in 3D space with coordinates <code>x</code>, <code>y</code>, and <code>z</code> of type <code>T</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/7b714d12e8c2ee90e8688dfb5c9faa117d3b4186/src/datastructures/Positions.jl#L5-L10">source</a></section></article><h2 id="Unit-cell"><a class="docs-heading-anchor" href="#Unit-cell">Unit cell</a><a id="Unit-cell-1"></a><a class="docs-heading-anchor-permalink" href="#Unit-cell" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.unitcell-Tuple{Chemfiles.Frame}" href="#MolSimToolkit.unitcell-Tuple{Chemfiles.Frame}"><code>MolSimToolkit.unitcell</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">unitcell(frame::Chemfiles.Frame)</code></pre><p>Returns the unit cell of the current frame in the trajectory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/7b714d12e8c2ee90e8688dfb5c9faa117d3b4186/src/datastructures/Simulation.jl#L341-L346">source</a></section></article><h2 id="Wrap-coordinates"><a class="docs-heading-anchor" href="#Wrap-coordinates">Wrap coordinates</a><a id="Wrap-coordinates-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-coordinates" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.wrap" href="#MolSimToolkit.wrap"><code>MolSimToolkit.wrap</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wrap(x, xref, unit_cell_matrix::SMatrix{N,N,T}) where {N,T}
wrap(x, xref, sides::AbstractVector)</code></pre><p>Wraps the coordinates of point <code>x</code> such that it is the minimum image relative to <code>xref</code>. The unit cell  may be given a a static matrix of size <code>(N,N)</code> or as a vector of length <code>N</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/7b714d12e8c2ee90e8688dfb5c9faa117d3b4186/src/wrap.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkit.wrap_to_first" href="#MolSimToolkit.wrap_to_first"><code>MolSimToolkit.wrap_to_first</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wrap_to_first(x, unit_cell_matrix)</code></pre><p>Wraps the coordinates of point <code>x</code> such that the returning coordinates are in the first unit cell with all-positive coordinates. The unit cell  has to be a matrix of size <code>(N,N)</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using MolSimToolkit

julia&gt; uc = [10 0 0; 0 10 0; 0 0 10]
UnitCell{Int64}
  10.000   0.000   0.000
   0.000  10.000   0.000
   0.000   0.000  10.000

julia&gt; wrap_to_first(Point3D(15.0, 13.0, 2.0), uc)
3-element SVector{3, Float64} with indices SOneTo(3):
 5.0
 3.0000000000000004
 2.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkit.jl/blob/7b714d12e8c2ee90e8688dfb5c9faa117d3b4186/src/wrap.jl#L31-L56">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../miscelaneous/">« Miscelaneous functions</a><a class="docs-footer-nextpage" href="../plotting_style/">Plotting style »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Tuesday 19 November 2024 12:11">Tuesday 19 November 2024</span>. Using Julia version 1.10.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
